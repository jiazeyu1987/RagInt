# 软件需求

## 1. 软件边界

本项目软件 = 前端（控制台/讲解UI/调试面板） + 后端（编排/状态/接口） + 对接（RAG/ASR/TTS/移动底盘或导航接口） + 数据（配置/日志/历史问答）。

## 2. 功能需求（FR）

### FR-1 连续讲解
- 支持“开始/暂停/继续/下一站/上一站/跳站/重置”
- 支持路线配置（站点顺序）与每站讲解时长（可选：目标字数作为辅助）
- 支持承接策略：上一站结束与下一站开头尽量自然，减少重复欢迎/过渡话术
- 到站后自动触发该站讲解（移动与讲解联动）

### FR-2 观众问答（打断机制）
- 新问题提交即取消旧 request（前后端一致）
- 旧流程停止：RAG SSE 停止、TTS 生成与播放停止、ASR 中断
- 问答结束后支持“继续讲解”（从当前站补充或进入下一站）

### FR-3 语音输入（ASR）
- 中文识别可用、延迟可接受（以现场可用为准）
- 识别失败要有语音提示(再说一遍/我没听清)

### FR-4 语音播报（TTS）
- 流式播放（边合成边播），避免白噪音与卡顿
- 支持关闭播报（仅文字）
- 支持 debug：首包延迟、chunk 统计
### FR-5 移动与站点到达
- 支持按站点移动：`go_to(站点)` / `cancel()` / `get_state()`（最小闭环）
- 到站判定要可配置（到位阈值/停靠点），到站成功后再进入讲解
- 移动失败或超时要提示并允许人工介入，不进入“假到站讲解”
- 打断时可取消移动（避免问答与移动冲突）
- 导航/底盘对接通过“导航适配器”实现，接口与字段以系统详细设计为准（见 `doc/robot/04-detailed-design.md`）

### FR-6 运维与可观测性
- 后端提供端口：返回关键阶段耗时与当前状态
- 前端提供调试面板

### FR-7 历史与复用
- 记录提问与回答；同问题计数聚合；点击历史可回填输入框

## 3. 非功能需求（NFR）
- NFR-1 延迟：首句播报尽可能 < 6s（现场网络允许时）
- NFR-2 稳定：长时间运行（>8h）不内存泄漏，不累积连接
- NFR-3 可维护：代码逻辑清晰
- NFR-4 可扩展：预留培训/教学接口方便日后扩展

